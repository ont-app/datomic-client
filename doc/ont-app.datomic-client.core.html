<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>ont-app.datomic-client.core documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Datomic-client</span> <span class="project-version">0.1.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ont-app</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>datomic-client</span></div></div></li><li class="depth-3 branch current"><a href="ont-app.datomic-client.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3"><a href="ont-app.datomic-client.ont.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ont</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-ask-s-p-o"><div class="inner"><span>ask-s-p-o</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-clear-edn-properties-cache.21"><div class="inner"><span>clear-edn-properties-cache!</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-clear-orphan-irrelevant-attributes-cache.21"><div class="inner"><span>clear-orphan-irrelevant-attributes-cache!</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-datomic-query"><div class="inner"><span>datomic-query</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-declare-edn-property.21"><div class="inner"><span>declare-edn-property!</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-domain-element.3F"><div class="inner"><span>domain-element?</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-edn-properties-cache"><div class="inner"><span>edn-properties-cache</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-edn-property.3F"><div class="inner"><span>edn-property?</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-ensure-igraph-schema"><div class="inner"><span>ensure-igraph-schema</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-entity-id"><div class="inner"><span>entity-id</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-get-normal-form"><div class="inner"><span>get-normal-form</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-get-subjects"><div class="inner"><span>get-subjects</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-igraph-rules"><div class="inner"><span>igraph-rules</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-igraph-schema"><div class="inner"><span>igraph-schema</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-make-graph"><div class="inner"><span>make-graph</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-map-value-to-value-type"><div class="inner"><span>map-value-to-value-type</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-maybe-encode-edn"><div class="inner"><span>maybe-encode-edn</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-maybe-read-edn"><div class="inner"><span>maybe-read-edn</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-normal-form-timeout"><div class="inner"><span>normal-form-timeout</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-ontology"><div class="inner"><span>ontology</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-orphan-irrelevant-attributes"><div class="inner"><span>orphan-irrelevant-attributes</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-orphan-irrelevant-attributes-cache"><div class="inner"><span>orphan-irrelevant-attributes-cache</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-orphaned.3F"><div class="inner"><span>orphaned?</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-query-arity"><div class="inner"><span>query-arity</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-query-for-o"><div class="inner"><span>query-for-o</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-query-for-p-o"><div class="inner"><span>query-for-p-o</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-query-response"><div class="inner"><span>query-response</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-remove-orphans"><div class="inner"><span>remove-orphans</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-retract-clauses-for-underspecified-triple"><div class="inner"><span>retract-clauses-for-underspecified-triple</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-standard-schema-elements"><div class="inner"><span>standard-schema-elements</span></div></a></li><li class="depth-1"><a href="ont-app.datomic-client.core.html#var-value-to-value-type-atom"><div class="inner"><span>value-to-value-type-atom</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">ont-app.datomic-client.core</h1><div class="doc"><pre class="plaintext">Ports datomic.client.api to IGraph protocol with accumulate-only mutability.
Defines a record DatomicClient
With parameters [&lt;conn&gt; &lt;db&gt;]
Where
&lt;conn&gt; is a datomic connection to some client
&lt;db&gt; is a DB in &lt;conn&gt; associated with some transaction.
</pre></div><div class="public anchor" id="var-ask-s-p-o"><h3>ask-s-p-o</h3><div class="usage"><code>(ask-s-p-o db s p o)</code></div><div class="doc"><pre class="plaintext">Returns true iff s-p-o is a triple in &lt;db&gt;
</pre></div></div><div class="public anchor" id="var-clear-edn-properties-cache.21"><h3>clear-edn-properties-cache!</h3><div class="usage"><code>(clear-edn-properties-cache!)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-clear-orphan-irrelevant-attributes-cache.21"><h3>clear-orphan-irrelevant-attributes-cache!</h3><div class="usage"><code>(clear-orphan-irrelevant-attributes-cache!)</code></div><div class="doc"><pre class="plaintext">Side-effect: removes all values in orphan-irrelevant-attributes-cache 
</pre></div></div><div class="public anchor" id="var-datomic-query"><h3>datomic-query</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Args: [db q]. Returns the result of a query `q` posed to `db`
Where
&lt;q&gt; is either a map conforming to datomic's arity-1 query or a vector
conforming to a :query clause, with implicit &lt;db&gt; as 2nd argument to d/q.</pre></div></div><div class="public anchor" id="var-declare-edn-property.21"><h3>declare-edn-property!</h3><div class="usage"><code>(declare-edn-property! db p)</code></div><div class="doc"><pre class="plaintext">Side-effect: declares `p` as an EDN property in `db`
</pre></div></div><div class="public anchor" id="var-domain-element.3F"><h3>domain-element?</h3><div class="usage"></div><div class="doc"><pre class="plaintext">True when a graph element is not part of the standard schema.
</pre></div></div><div class="public anchor" id="var-edn-properties-cache"><h3>edn-properties-cache</h3><div class="usage"></div><div class="doc"><pre class="plaintext">Caches the set of properties which store EDN strings for a given DB.
{&lt;db&gt; #{&lt;property&gt;, ...}, ...}</pre></div></div><div class="public anchor" id="var-edn-property.3F"><h3>edn-property?</h3><div class="usage"><code>(edn-property? db p)</code></div><div class="doc"><pre class="plaintext">Returns true iff (g `p` :igraph/edn? true) for g of `db`
Where
&lt;p&gt; names a property in &lt;db&gt;
Note: typically used when deciding whether to encode/decode objects as edn.</pre></div></div><div class="public anchor" id="var-ensure-igraph-schema"><h3>ensure-igraph-schema</h3><div class="usage"><code>(ensure-igraph-schema conn)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-entity-id"><h3>entity-id</h3><div class="usage"><code>(entity-id db s)</code></div><div class="doc"><pre class="plaintext">Returns &lt;e&gt; for &lt;s&gt; in &lt;db&gt;
Where
&lt;e&gt; is the entity ID (a positive integer) in (:db &lt;g&gt;)
&lt;s&gt; is a subject s.t. [&lt;e&gt; ::id &lt;s&gt;] in (:db &lt;g&gt;)
&lt;g&gt; is an instance of DatascriptGraph</pre></div></div><div class="public anchor" id="var-get-normal-form"><h3>get-normal-form</h3><div class="usage"><code>(get-normal-form db)</code></div><div class="doc"><pre class="plaintext">Returns &lt;desc&gt; for &lt;s&gt; in &lt;db&gt;
Where
&lt;desc&gt; := {&lt;p&gt; #{&lt;o&gt;, ...}, ...}</pre></div></div><div class="public anchor" id="var-get-subjects"><h3>get-subjects</h3><div class="usage"><code>(get-subjects db)</code></div><div class="doc"><pre class="plaintext">Returns (&lt;s&gt;, ...) for &lt;db&gt;, a lazy seq
Where
&lt;s&gt; is a unique identifier for some &lt;e&gt;
&lt;db&gt; is a datomic db
&lt;e&gt; &lt;unique-id&gt; &lt;s&gt;, in &lt;db&gt;
&lt;e&gt; is an entity-id
&lt;unique-id&gt; is any &lt;p&gt; s.t. &lt;p&gt;'s datatype is a unique ID.</pre></div></div><div class="public anchor" id="var-igraph-rules"><h3>igraph-rules</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-igraph-schema"><h3>igraph-schema</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-make-graph"><h3>make-graph</h3><div class="usage"><code>(make-graph conn)</code><code>(make-graph conn db)</code></div><div class="doc"><pre class="plaintext">Returns an instance of DatascriptGraph for `conn` and optional `db`
Where
&lt;conn&gt; is a transactor, presumably initialized for domain-specific schemas
&lt;db&gt; (optional) is a db filter on `conn`, default is the db as-of the
  current basis-t of &lt;conn&gt;
</pre></div></div><div class="public anchor" id="var-map-value-to-value-type"><h3>map-value-to-value-type</h3><div class="usage"><code>(map-value-to-value-type value)</code></div><div class="doc"><pre class="plaintext">Returns a :db.type/* for &lt;value&gt;, or :edn-string 
Where 
&lt;value&gt; is some graph element being claimed/retracted on some g
:edn-string signals that &lt;value&gt; should be stored as an EDN string.</pre></div></div><div class="public anchor" id="var-maybe-encode-edn"><h3>maybe-encode-edn</h3><div class="usage"><code>(maybe-encode-edn db p o)</code></div><div class="doc"><pre class="plaintext">Returns an EDN string for `o` if (edn-property? `p`) else `o`
</pre></div></div><div class="public anchor" id="var-maybe-read-edn"><h3>maybe-read-edn</h3><div class="usage"><code>(maybe-read-edn db p o)</code></div><div class="doc"><pre class="plaintext">Returns the clojure object read from `o` if (edn-property? `p`) else `o`
</pre></div></div><div class="public anchor" id="var-normal-form-timeout"><h3>normal-form-timeout</h3><div class="usage"></div><div class="doc"><pre class="plaintext">Sets the timeout in ms for normal form query
</pre></div></div><div class="public anchor" id="var-ontology"><h3>ontology</h3><div class="usage"></div><div class="doc"><pre class="plaintext">An igraph.graph/Graph describing the various elements in
datomic-client. Primarily documentatry at this point. </pre></div></div><div class="public anchor" id="var-orphan-irrelevant-attributes"><h3>orphan-irrelevant-attributes</h3><div class="usage"><code>(orphan-irrelevant-attributes conn)</code></div><div class="doc"><pre class="plaintext">Returns #{&lt;insignificant-attribute&gt;, ...} for &lt;conn&gt;
Where
&lt;insignificant attribute&gt; is ignored when determining orphan-dom.</pre></div></div><div class="public anchor" id="var-orphan-irrelevant-attributes-cache"><h3>orphan-irrelevant-attributes-cache</h3><div class="usage"></div><div class="doc"><pre class="plaintext">Caches attributes irrelevant to determining orphans for some `conn`
{&lt;conn&gt; #{&lt;attribute&gt;, ....}}
</pre></div></div><div class="public anchor" id="var-orphaned.3F"><h3>orphaned?</h3><div class="usage"><code>(orphaned? db insignificant-attribute? e)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-query-arity"><h3>query-arity</h3><div class="usage"><code>(query-arity q)</code></div><div class="doc"><pre class="plaintext">Returns either :arity-1 or :arity-2 depending on the type of `q`
Where
&lt;q&gt; is a query posed to a datomic db.
Maps are arity-1 and vectors are arity-2, with implicit db as 2nd arg</pre></div></div><div class="public anchor" id="var-query-for-o"><h3>query-for-o</h3><div class="usage"><code>(query-for-o db s p)</code></div><div class="doc"><pre class="plaintext">Returns #{&lt;o&gt;, ...} for `s` and `p` in `db`
Where
&lt;o&gt; is a value for &lt;db&gt; s.t. &lt;s&gt; &lt;p&gt;  &lt;o&gt; 
&lt;s&gt; is a subject in &lt;db&gt;
&lt;p&gt; is a predicate with schema definition in &lt;db&gt;
&lt;db&gt; is a datomic DB</pre></div></div><div class="public anchor" id="var-query-for-p-o"><h3>query-for-p-o</h3><div class="usage"><code>(query-for-p-o db s)</code></div><div class="doc"><pre class="plaintext">Returns &lt;desc&gt; for &lt;s&gt; in &lt;db&gt;
Where
&lt;desc&gt; := {&lt;p&gt; #{&lt;o&gt;, ...}, ...}</pre></div></div><div class="public anchor" id="var-query-response"><h3>query-response</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-remove-orphans"><h3>remove-orphans</h3><div class="usage"><code>(remove-orphans g)</code><code>(remove-orphans g candidates)</code></div><div class="doc"><pre class="plaintext">Returns &lt;g'&gt;, s.t. `candidates` are removed if they are orphans
   i.e. not connected to other elements.
Side-effect: (:conn g)  will be modified accordingly.
Where
&lt;g&gt; is a datomic-client
&lt;candidates&gt; := #{&lt;elt&gt;, ...}, (or any sequence) default (subjects g)
&lt;elt&gt; is an element in &lt;g&gt; which we suspect might be an orphan. It may be
  an integer entity ID or a keyword unique identifier.
</pre></div></div><div class="public anchor" id="var-retract-clauses-for-underspecified-triple"><h3>retract-clauses-for-underspecified-triple</h3><div class="usage"><code>(retract-clauses-for-underspecified-triple affected-entity-fn g to-remove)</code></div><div class="doc"><pre class="plaintext">Returns [&lt;retraction-clause&gt;, ...] for `to-remove` from `db`
Where
&lt;retraction-clause&gt; := [&lt;op&gt; &lt;elt&gt; ...]
&lt;g&gt; is a 
&lt;op&gt; is in #{:db/retract :db/retractEntity}
&lt;elt&gt; is an element of &lt;g&gt;
&lt;affected-entity-fn&gt; := fn [elt] -&gt; &lt;entity-id&gt;, typically with the side-effect 
  of registering a possible orphan in the calling function.
&lt;entity-id&gt; is the numeric id of &lt;elt&gt; in &lt;g&gt;</pre></div></div><div class="public anchor" id="var-standard-schema-elements"><h3>standard-schema-elements</h3><div class="usage"></div><div class="doc"><pre class="plaintext">The set of elements provided at time of schema creation.
</pre></div></div><div class="public anchor" id="var-value-to-value-type-atom"><h3>value-to-value-type-atom</h3><div class="usage"></div><div class="doc"><pre class="plaintext">From <a href="https://docs.datomic.com/cloud/schema/schema-reference.html#db-valuetype">https://docs.datomic.com/cloud/schema/schema-reference.html#db-valuetype</a>
</pre></div></div></div></body></html>